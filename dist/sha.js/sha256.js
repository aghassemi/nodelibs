var inherits=require("../util").inherits,BE=!1,LE=!0,hexpp=require("./hexpp"),u=require("./util");module.exports=function(e,t){function r(){p.length,this.init(),this._w=l,t.call(this,64,56)}function n(e,t){return e>>>t|e<<32-t}function i(e,t){return e>>>t}function s(e,t,r){return e&t^~e&r}function o(e,t,r){return e&t^e&r^t&r}function a(e){return n(e,2)^n(e,13)^n(e,22)}function u(e){return n(e,6)^n(e,11)^n(e,25)}function f(e){return n(e,7)^n(e,18)^i(e,3)}function h(e){return n(e,17)^n(e,19)^i(e,10)}var c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];inherits(r,t);var l=new Array(64),p=[];r.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._len=this._s=0,this};return r.prototype._update=function(){var e,t,r,n,i,l,p,d,g,y,v=this._block,m=this._w;e=0|this._a,t=0|this._b,r=0|this._c,n=0|this._d,i=0|this._e,l=0|this._f,p=0|this._g,d=0|this._h;for(var b=0;64>b;b++){var _=m[b]=16>b?v.readInt32BE(4*b):h(m[b-2])+m[b-7]+f(m[b-15])+m[b-16];g=d+u(i)+s(i,l,p)+c[b]+_,y=a(e)+o(e,t,r),d=p,p=l,l=i,i=n+g,n=r,r=t,t=e,e=g+y}this._a=e+this._a|0,this._b=t+this._b|0,this._c=r+this._c|0,this._d=n+this._d|0,this._e=i+this._e|0,this._f=l+this._f|0,this._g=p+this._g|0,this._h=d+this._h|0},r.prototype._hash=function(){p.length<10&&p.push(this);var t=new e(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},r};