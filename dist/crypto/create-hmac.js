function Hmac(S,E){if(!(this instanceof Hmac))return new Hmac(S,E);this._opad=O,this._alg=S,E=this._key=Buffer.isBuffer(E)?E:new Buffer(E),E.length>blocksize?E=createHash(S).update(E).digest():E.length<blocksize&&(E=Buffer.concat([E,zeroBuffer],blocksize));for(var _=this._ipad=new Buffer(blocksize),O=this._opad=new Buffer(blocksize),e=0;blocksize>e;e++)_[e]=54^E[e],O[e]=92^E[e];this._hash=createHash(S).update(_)}var createHash=require("./create-hash"),blocksize=64,zeroBuffer=new Buffer(blocksize);zeroBuffer.fill(0),module.exports=Hmac,Hmac.prototype.update=function(S,E){return this._hash.update(S,E),this},Hmac.prototype.digest=function(S){var E=this._hash.digest();return createHash(this._alg).update(this._opad).update(E).digest(S)};