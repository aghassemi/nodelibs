// Copyright Joyent, Inc. and other Node contributors.
"use strict";function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}module.exports=function(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a=e.length;s>0&&a>s&&(a=s);for(var u=0;a>u;++u){var _,f,h,c,E=e[u].replace(o,"%20"),d=E.indexOf(r);d>=0?(_=E.substr(0,d),f=E.substr(d+1)):(_=E,f=""),h=decodeURIComponent(_),c=decodeURIComponent(f),hasOwnProperty(i,h)?Array.isArray(i[h])?i[h].push(c):i[h]=[i[h],c]:i[h]=c}return i};