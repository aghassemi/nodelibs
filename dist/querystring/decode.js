// Copyright Joyent, Inc. and other Node contributors.
"use strict";function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}module.exports=function(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var s=/\+/g;e=e.split(t);var o=1e3;n&&"number"==typeof n.maxKeys&&(o=n.maxKeys);var _=e.length;o>0&&_>o&&(_=o);for(var u=0;_>u;++u){var f,E,a,h,S=e[u].replace(s,"%20"),m=S.indexOf(r);m>=0?(f=S.substr(0,m),E=S.substr(m+1)):(f=S,E=""),a=decodeURIComponent(f),h=decodeURIComponent(E),hasOwnProperty(i,a)?Array.isArray(i[a])?i[a].push(h):i[a]=[i[a],h]:i[a]=h}return i};