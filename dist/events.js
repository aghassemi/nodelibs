// Copyright Joyent, Inc. and other Node contributors.
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,_,i,n,r,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(_=this._events[e],isUndefined(_))return!1;if(isFunction(_))switch(arguments.length){case 1:_.call(this);break;case 2:_.call(this,arguments[1]);break;case 3:_.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,n=new Array(i-1),r=1;i>r;r++)n[r-1]=arguments[r];_.apply(this,n)}else if(isObject(_)){for(i=arguments.length,n=new Array(i-1),r=1;i>r;r++)n[r-1]=arguments[r];for(s=_.slice(),i=s.length,r=0;i>r;r++)s[r].apply(this,n)}return!0},EventEmitter.prototype.addListener=function(e,t){var _;if(!isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned){var _;_=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,_&&_>0&&this._events[e].length>_&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function _(){this.removeListener(e,_),i||(i=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var i=!1;return _.listener=t,this.on(e,_),this},EventEmitter.prototype.removeListener=function(e,t){var _,i,n,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(_=this._events[e],n=_.length,i=-1,_===t||isFunction(_.listener)&&_.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(_)){for(r=n;r-->0;)if(_[r]===t||_[r].listener&&_[r].listener===t){i=r;break}if(0>i)return this;1===_.length?(_.length=0,delete this._events[e]):_.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,_;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(_=this._events[e],isFunction(_))this.removeListener(e,_);else for(;_.length;)this.removeListener(e,_[_.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.listenerCount=function(e,t){var _;return _=e._events&&e._events[t]?isFunction(e._events[t])?1:e._events[t].length:0};